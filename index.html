<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Beginner's Luck - Account Registration</title>
  </head>
  <body>
    <link rel="stylesheet" href="/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap"
      rel="stylesheet"
    />
    <div class="background">
      <div class="shape"></div>
      <div class="shape"></div>
    </div>

    <div id="widget" class="skWidget widget">
      <!--Widget should appear here.-->
    </div>

    <script
      type="text/javascript"
      src="https://pingsandboxsdk.singularkey.com/latest/singularkey.js"
    ></script>
    <script>
      //*** Populate the below parameters from your SingularKey environment ***/
      const skApiBaseUrl = "https://pingsandboxapi.singularkey.com/v1";
      const companyId = "M7HTHrBYXSuk9NavS7zHwlK96kwODxV1";
      const skApiKey ="2GKLLeJUEyoOOyFdJ01kohmCk3uXjN37Nl50XM4yjj0T8dZ4nSku2yi3ZaoIcMsTz2aaKHZvYSYeZuqzhyQ0UaoJ6adxIAO9iSOAmh86QUc6RecVZ3hKYZem4LuFcabaL7bxOEWaVtWiKI7dkhhYdJHw37N6xD9dMLkwis4GJb6Rlpc9eRwkBP1y3ArCrqjdyfoQSdjw5HPLJz7m9d45eTWh1PFwBqzM1Ntmw728nW7Db7lotUuQ40HestAf9Twz";
      const skFlowId = "6sYQDMn9sJIhHTza0gCRa3kTJGbStCge";
      const skPolicyId = "CwQ54il2JgNv8uju1UTg6RYQfCe7f4d4";
      const skGetTokenUrl =
        skApiBaseUrl + "/company/" + companyId + "/sdkToken";

      //*** Add the API Key from your SK Application. ***/
      var headers = new Headers();
      headers.append("X-SK-API-KEY", skApiKey);
      headers.append("Content-type", "application/json");

      var requestOptions = {
        method: "GET",
        headers: headers,
        redirect: "follow",
      };

      //*** Retrieve SK Token ***/
      fetch(skGetTokenUrl, requestOptions)
        .then((response) => response.json())
        .then((responseData) => {
          var props = {
            config: {
              method: "runFlow",
              apiRoot: skApiBaseUrl,
              accessToken: responseData.access_token,
              companyId: companyId,
              flowId: skFlowId,
              policyId: skPolicyId,
            },
            useModal: false,
            successCallback,
            errorCallback,
            onCloseModal,
          };
          /*** Invoke Singular Key Widget ****/
          console.log(props);
          singularkey.skRenderScreen(
            document.getElementsByClassName("skWidget")[0],
            props
          );
        })
        .catch((error) => console.log("error", error));

      function successCallback(response) {
        console.log(response);
      }

      function errorCallback(error) {
        console.log(error);
      }

      function onCloseModal() {
        console.log("onCloseModal");
      }
    </script>
    <footer class="footer">
      <div class="links"></div>
      <a
        class="btn--remix"
        target="_top"
        href="https://glitch.com/edit/#!/remix/sko-sk-debugging"
      >
        <img
          src="https://cdn.glitch.com/605e2a51-d45f-4d87-a285-9410ad350515%2FLogo_Color.svg?v=1618199565140"
          alt=""
        />
        Remix on Glitch
      </a>
    </footer>
  </body>
</html>
